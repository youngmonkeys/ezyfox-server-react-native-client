{"version":3,"names":["Proxy","Manager","EzySetup","Const","EzyLogger","EzyClient","constructor","config","callback","run2","toMap","outputConfig","name","clientName","enableSSL","enableDebug","zone","me","handlerManager","EzyHandlerManager","setup","connect","host","port","privateKey","sessionKey","run","reconnect","disconnect","reason","r","EzyDisconnectReason","CLOSE","close","send","cmd","data","encrypted","shouldEncrypted","error","params","requestParams","command","request","startPingSchedule","setStatus","status","setSessionKey","getApp","appManager","app","getAppById","appId","getPluginById","pluginId","pluginManager","newAppManager","zoneName","EzyAppManager","getAppManager","getPluginManager","handleEvent","eventType","eventHandlers","handle","handleData","dataHandlers"],"sources":["ezy-client.js"],"sourcesContent":["import Proxy from './proxy';\nimport Manager from './ezy-managers';\nimport EzySetup from './ezy-setup';\nimport Const from './ezy-constants';\nimport EzyLogger from './ezy-logger';\n\nclass EzyClient {\n    constructor(config, callback) {\n        Proxy.run2('init', config.toMap(), (outputConfig) => {\n            this.config = outputConfig;\n            this.name = outputConfig.clientName;\n            this.enableSSL = config.enableSSL;\n            this.enableDebug = config.enableDebug;\n            this.zone = null;\n            this.me = null;\n            this.handlerManager = new Manager.EzyHandlerManager(this);\n            this.setup = new EzySetup(this.handlerManager);\n            callback(this);\n        });\n    }\n\n    connect(host, port) {\n        this.privateKey = null;\n        this.sessionKey = null;\n        Proxy.run('connect', { clientName: this.name, host: host, port: port });\n    }\n\n    reconnect(callback) {\n        this.privateKey = null;\n        this.sessionKey = null;\n        Proxy.run2('reconnect', { clientName: this.name }, callback);\n    }\n\n    disconnect(reason) {\n        var r = reason ? reason : Const.EzyDisconnectReason.CLOSE;\n        Proxy.run('disconnect', { clientName: this.name, reason: r });\n    }\n\n    close() {\n        this.disconnect();\n    }\n\n    send(cmd, data, encrypted) {\n        var shouldEncrypted = encrypted;\n        if (encrypted && !this.sessionKey) {\n            if (this.enableDebug) {\n                shouldEncrypted = false;\n            } else {\n                EzyLogger.error(\n                    'can not send command: $cmd, you must enable SSL ' +\n                        'or enable debug mode by configuration when you create the client'\n                );\n                return;\n            }\n        }\n        var params = {};\n        params.clientName = this.name;\n        var requestParams = {};\n        requestParams.command = cmd;\n        requestParams.data = data;\n        requestParams.encrypted = shouldEncrypted;\n        params.request = requestParams;\n        Proxy.run('send', params);\n    }\n\n    startPingSchedule() {\n        Proxy.run('startPingSchedule', { clientName: this.name });\n    }\n\n    setStatus(status) {\n        Proxy.run('setStatus', { clientName: this.name, status: status });\n    }\n\n    setSessionKey(sessionKey) {\n        Proxy.run('setSessionKey', {\n            clientName: this.name,\n            sessionKey: sessionKey,\n        });\n    }\n\n    getApp() {\n        if (this.zone) {\n            var appManager = this.zone.appManager;\n            var app = appManager.getApp();\n            return app;\n        }\n        return null;\n    }\n\n    getAppById(appId) {\n        if (!this.zone) return null;\n        var appManager = this.zone.appManager;\n        return appManager.getAppById(appId);\n    }\n\n    getPluginById(pluginId) {\n        if (!this.zone) return null;\n        var pluginManager = this.zone.pluginManager;\n        return pluginManager.getPluginById(pluginId);\n    }\n\n    newAppManager(zoneName) {\n        return new Manager.EzyAppManager(zoneName);\n    }\n\n    getAppManager() {\n        if (!this.zone) return null;\n        return this.zone.appManager;\n    }\n\n    getPluginManager() {\n        if (!this.zone) return null;\n        return this.zone.pluginManager;\n    }\n\n    handleEvent(eventType, data) {\n        var eventHandlers = this.handlerManager.eventHandlers;\n        eventHandlers.handle(eventType, data);\n    }\n\n    handleData(command, data) {\n        var dataHandlers = this.handlerManager.dataHandlers;\n        dataHandlers.handle(command, data);\n    }\n}\n\nexport default EzyClient;\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,SAAS;AAC3B,OAAOC,OAAO,MAAM,gBAAgB;AACpC,OAAOC,QAAQ,MAAM,aAAa;AAClC,OAAOC,KAAK,MAAM,iBAAiB;AACnC,OAAOC,SAAS,MAAM,cAAc;AAEpC,MAAMC,SAAS,CAAC;EACZC,WAAWA,CAACC,MAAM,EAAEC,QAAQ,EAAE;IAC1BR,KAAK,CAACS,IAAI,CAAC,MAAM,EAAEF,MAAM,CAACG,KAAK,CAAC,CAAC,EAAGC,YAAY,IAAK;MACjD,IAAI,CAACJ,MAAM,GAAGI,YAAY;MAC1B,IAAI,CAACC,IAAI,GAAGD,YAAY,CAACE,UAAU;MACnC,IAAI,CAACC,SAAS,GAAGP,MAAM,CAACO,SAAS;MACjC,IAAI,CAACC,WAAW,GAAGR,MAAM,CAACQ,WAAW;MACrC,IAAI,CAACC,IAAI,GAAG,IAAI;MAChB,IAAI,CAACC,EAAE,GAAG,IAAI;MACd,IAAI,CAACC,cAAc,GAAG,IAAIjB,OAAO,CAACkB,iBAAiB,CAAC,IAAI,CAAC;MACzD,IAAI,CAACC,KAAK,GAAG,IAAIlB,QAAQ,CAAC,IAAI,CAACgB,cAAc,CAAC;MAC9CV,QAAQ,CAAC,IAAI,CAAC;IAClB,CAAC,CAAC;EACN;EAEAa,OAAOA,CAACC,IAAI,EAAEC,IAAI,EAAE;IAChB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtBzB,KAAK,CAAC0B,GAAG,CAAC,SAAS,EAAE;MAAEb,UAAU,EAAE,IAAI,CAACD,IAAI;MAAEU,IAAI,EAAEA,IAAI;MAAEC,IAAI,EAAEA;IAAK,CAAC,CAAC;EAC3E;EAEAI,SAASA,CAACnB,QAAQ,EAAE;IAChB,IAAI,CAACgB,UAAU,GAAG,IAAI;IACtB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtBzB,KAAK,CAACS,IAAI,CAAC,WAAW,EAAE;MAAEI,UAAU,EAAE,IAAI,CAACD;IAAK,CAAC,EAAEJ,QAAQ,CAAC;EAChE;EAEAoB,UAAUA,CAACC,MAAM,EAAE;IACf,IAAIC,CAAC,GAAGD,MAAM,GAAGA,MAAM,GAAG1B,KAAK,CAAC4B,mBAAmB,CAACC,KAAK;IACzDhC,KAAK,CAAC0B,GAAG,CAAC,YAAY,EAAE;MAAEb,UAAU,EAAE,IAAI,CAACD,IAAI;MAAEiB,MAAM,EAAEC;IAAE,CAAC,CAAC;EACjE;EAEAG,KAAKA,CAAA,EAAG;IACJ,IAAI,CAACL,UAAU,CAAC,CAAC;EACrB;EAEAM,IAAIA,CAACC,GAAG,EAAEC,IAAI,EAAEC,SAAS,EAAE;IACvB,IAAIC,eAAe,GAAGD,SAAS;IAC/B,IAAIA,SAAS,IAAI,CAAC,IAAI,CAACZ,UAAU,EAAE;MAC/B,IAAI,IAAI,CAACV,WAAW,EAAE;QAClBuB,eAAe,GAAG,KAAK;MAC3B,CAAC,MAAM;QACHlC,SAAS,CAACmC,KAAK,CACX,kDAAkD,GAC9C,kEACR,CAAC;QACD;MACJ;IACJ;IACA,IAAIC,MAAM,GAAG,CAAC,CAAC;IACfA,MAAM,CAAC3B,UAAU,GAAG,IAAI,CAACD,IAAI;IAC7B,IAAI6B,aAAa,GAAG,CAAC,CAAC;IACtBA,aAAa,CAACC,OAAO,GAAGP,GAAG;IAC3BM,aAAa,CAACL,IAAI,GAAGA,IAAI;IACzBK,aAAa,CAACJ,SAAS,GAAGC,eAAe;IACzCE,MAAM,CAACG,OAAO,GAAGF,aAAa;IAC9BzC,KAAK,CAAC0B,GAAG,CAAC,MAAM,EAAEc,MAAM,CAAC;EAC7B;EAEAI,iBAAiBA,CAAA,EAAG;IAChB5C,KAAK,CAAC0B,GAAG,CAAC,mBAAmB,EAAE;MAAEb,UAAU,EAAE,IAAI,CAACD;IAAK,CAAC,CAAC;EAC7D;EAEAiC,SAASA,CAACC,MAAM,EAAE;IACd9C,KAAK,CAAC0B,GAAG,CAAC,WAAW,EAAE;MAAEb,UAAU,EAAE,IAAI,CAACD,IAAI;MAAEkC,MAAM,EAAEA;IAAO,CAAC,CAAC;EACrE;EAEAC,aAAaA,CAACtB,UAAU,EAAE;IACtBzB,KAAK,CAAC0B,GAAG,CAAC,eAAe,EAAE;MACvBb,UAAU,EAAE,IAAI,CAACD,IAAI;MACrBa,UAAU,EAAEA;IAChB,CAAC,CAAC;EACN;EAEAuB,MAAMA,CAAA,EAAG;IACL,IAAI,IAAI,CAAChC,IAAI,EAAE;MACX,IAAIiC,UAAU,GAAG,IAAI,CAACjC,IAAI,CAACiC,UAAU;MACrC,IAAIC,GAAG,GAAGD,UAAU,CAACD,MAAM,CAAC,CAAC;MAC7B,OAAOE,GAAG;IACd;IACA,OAAO,IAAI;EACf;EAEAC,UAAUA,CAACC,KAAK,EAAE;IACd,IAAI,CAAC,IAAI,CAACpC,IAAI,EAAE,OAAO,IAAI;IAC3B,IAAIiC,UAAU,GAAG,IAAI,CAACjC,IAAI,CAACiC,UAAU;IACrC,OAAOA,UAAU,CAACE,UAAU,CAACC,KAAK,CAAC;EACvC;EAEAC,aAAaA,CAACC,QAAQ,EAAE;IACpB,IAAI,CAAC,IAAI,CAACtC,IAAI,EAAE,OAAO,IAAI;IAC3B,IAAIuC,aAAa,GAAG,IAAI,CAACvC,IAAI,CAACuC,aAAa;IAC3C,OAAOA,aAAa,CAACF,aAAa,CAACC,QAAQ,CAAC;EAChD;EAEAE,aAAaA,CAACC,QAAQ,EAAE;IACpB,OAAO,IAAIxD,OAAO,CAACyD,aAAa,CAACD,QAAQ,CAAC;EAC9C;EAEAE,aAAaA,CAAA,EAAG;IACZ,IAAI,CAAC,IAAI,CAAC3C,IAAI,EAAE,OAAO,IAAI;IAC3B,OAAO,IAAI,CAACA,IAAI,CAACiC,UAAU;EAC/B;EAEAW,gBAAgBA,CAAA,EAAG;IACf,IAAI,CAAC,IAAI,CAAC5C,IAAI,EAAE,OAAO,IAAI;IAC3B,OAAO,IAAI,CAACA,IAAI,CAACuC,aAAa;EAClC;EAEAM,WAAWA,CAACC,SAAS,EAAE1B,IAAI,EAAE;IACzB,IAAI2B,aAAa,GAAG,IAAI,CAAC7C,cAAc,CAAC6C,aAAa;IACrDA,aAAa,CAACC,MAAM,CAACF,SAAS,EAAE1B,IAAI,CAAC;EACzC;EAEA6B,UAAUA,CAACvB,OAAO,EAAEN,IAAI,EAAE;IACtB,IAAI8B,YAAY,GAAG,IAAI,CAAChD,cAAc,CAACgD,YAAY;IACnDA,YAAY,CAACF,MAAM,CAACtB,OAAO,EAAEN,IAAI,CAAC;EACtC;AACJ;AAEA,eAAe/B,SAAS"}