{"version":3,"names":["_ezyConstants","_interopRequireDefault","require","_ezyHandlers","_ezyLogger","obj","__esModule","default","EzyAppManager","constructor","zoneName","appList","appsById","appsByName","getApp","app","length","console","log","addApp","push","id","name","removeApp","appId","filter","item","getAppById","getAppByName","EzyPluginManager","pluginList","pluginsById","pluginsByName","getPlugin","plugin","EzyLogger","warn","addPlugin","getPluginById","getPluginByName","EzyPingManager","pingPeriod","lostPingCount","maxLostPingCount","increaseLostPingCount","EzyHandlerManager","client","dataHandlers","newDataHandlers","eventHandlers","newEventHandlers","appDataHandlerss","pluginDataHandlerss","handlers","Handler","EzyEventHandlers","addHandler","Const","EzyEventType","CONNECTION_SUCCESS","EzyConnectionSuccessHandler","CONNECTION_FAILURE","EzyConnectionFailureHandler","DISCONNECTION","EzyDisconnectionHandler","EzyDataHandlers","EzyCommand","PONG","EzyPongHandler","HANDSHAKE","EzyHandshakeHandler","LOGIN","EzyLoginSuccessHandler","LOGIN_ERROR","EzyLoginErrorHandler","APP_ACCESS","EzyAppAccessHandler","APP_REQUEST","EzyAppResponseHandler","APP_EXIT","EzyAppExitHandler","PLUGIN_INFO","EzyPluginInfoHandler","PLUGIN_REQUEST","EzyPluginResponseHandler","getDataHandler","cmd","handler","getHandler","getEventHandler","eventType","getAppDataHandlers","appName","answer","EzyAppDataHandlers","getPluginDataHandlers","pluginName","EzyPluginDataHandlers","addDataHandler","dataHandler","addEventHandler","eventHandler","_default","exports"],"sources":["ezy-managers.js"],"sourcesContent":["import Const from './ezy-constants';\nimport Handler from './ezy-handlers';\nimport EzyLogger from './ezy-logger';\n\nclass EzyAppManager {\n    constructor(zoneName) {\n        this.zoneName = zoneName;\n        this.appList = [];\n        this.appsById = {};\n        this.appsByName = {};\n    }\n\n    getApp() {\n        var app = null;\n        if (this.appList.length > 0) app = this.appList[0];\n        else console.log('has no app in zone: ' + this.zoneName);\n        return app;\n    }\n\n    addApp(app) {\n        this.appList.push(app);\n        this.appsById[app.id] = app;\n        this.appsByName[app.name] = app;\n    }\n\n    removeApp(appId) {\n        var app = this.appsById[appId];\n        if (app) {\n            delete this.appsById[appId];\n            delete this.appsByName[app.name];\n            this.appList = this.appList.filter((item) => item.id !== appId);\n        }\n        return app;\n    }\n\n    getAppById(id) {\n        var app = this.appsById[id];\n        return app;\n    }\n\n    getAppByName(name) {\n        var app = this.appsByName[name];\n        return app;\n    }\n}\n\n//======================================\n\nclass EzyPluginManager {\n    constructor(zoneName) {\n        this.zoneName = zoneName;\n        this.pluginList = [];\n        this.pluginsById = {};\n        this.pluginsByName = {};\n    }\n\n    getPlugin() {\n        var plugin = null;\n        if (this.pluginList.length > 0) plugin = this.pluginList[0];\n        else EzyLogger.warn('has no plugin in zone: ' + this.zoneName);\n        return plugin;\n    }\n\n    addPlugin(plugin) {\n        this.pluginList.push(plugin);\n        this.pluginsById[plugin.id] = plugin;\n        this.pluginsByName[plugin.name] = plugin;\n    }\n\n    getPluginById(id) {\n        var plugin = this.pluginsById[id];\n        return plugin;\n    }\n\n    getPluginByName(name) {\n        var plugin = this.pluginsByName[name];\n        return plugin;\n    }\n}\n\n//======================================\n\nclass EzyPingManager {\n    constructor() {\n        this.pingPeriod = 5000;\n        this.lostPingCount = 0;\n        this.maxLostPingCount = 5;\n    }\n\n    increaseLostPingCount() {\n        return ++this.lostPingCount;\n    }\n}\n\n//===================================================\n\nclass EzyHandlerManager {\n    constructor(client) {\n        this.client = client;\n        this.dataHandlers = this.newDataHandlers();\n        this.eventHandlers = this.newEventHandlers();\n        this.appDataHandlerss = {};\n        this.pluginDataHandlerss = {};\n    }\n\n    newEventHandlers() {\n        var handlers = new Handler.EzyEventHandlers(this.client);\n        handlers.addHandler(\n            Const.EzyEventType.CONNECTION_SUCCESS,\n            new Handler.EzyConnectionSuccessHandler()\n        );\n        handlers.addHandler(\n            Const.EzyEventType.CONNECTION_FAILURE,\n            new Handler.EzyConnectionFailureHandler()\n        );\n        handlers.addHandler(\n            Const.EzyEventType.DISCONNECTION,\n            new Handler.EzyDisconnectionHandler()\n        );\n        return handlers;\n    }\n\n    newDataHandlers() {\n        var handlers = new Handler.EzyDataHandlers(this.client);\n        handlers.addHandler(\n            Const.EzyCommand.PONG,\n            new Handler.EzyPongHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.HANDSHAKE,\n            new Handler.EzyHandshakeHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.LOGIN,\n            new Handler.EzyLoginSuccessHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.LOGIN_ERROR,\n            new Handler.EzyLoginErrorHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.APP_ACCESS,\n            new Handler.EzyAppAccessHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.APP_REQUEST,\n            new Handler.EzyAppResponseHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.APP_EXIT,\n            new Handler.EzyAppExitHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.PLUGIN_INFO,\n            new Handler.EzyPluginInfoHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.PLUGIN_REQUEST,\n            new Handler.EzyPluginResponseHandler()\n        );\n        return handlers;\n    }\n\n    getDataHandler(cmd) {\n        var handler = this.dataHandlers.getHandler(cmd);\n        return handler;\n    }\n\n    getEventHandler(eventType) {\n        var handler = this.eventHandlers.getHandler(eventType);\n        return handler;\n    }\n\n    getAppDataHandlers(appName) {\n        var answer = this.appDataHandlerss[appName];\n        if (!answer) {\n            answer = new Handler.EzyAppDataHandlers();\n            this.appDataHandlerss[appName] = answer;\n        }\n        return answer;\n    }\n\n    getPluginDataHandlers(pluginName) {\n        var answer = this.pluginDataHandlerss[pluginName];\n        if (!answer) {\n            answer = new Handler.EzyPluginDataHandlers();\n            this.pluginDataHandlerss[pluginName] = answer;\n        }\n        return answer;\n    }\n\n    addDataHandler(cmd, dataHandler) {\n        this.dataHandlers.addHandler(cmd, dataHandler);\n    }\n\n    addEventHandler(eventType, eventHandler) {\n        this.eventHandlers.addHandler(eventType, eventHandler);\n    }\n}\n//===================================================\n\nexport default {\n    EzyAppManager,\n    EzyPluginManager,\n    EzyPingManager,\n    EzyHandlerManager,\n};\n"],"mappings":"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"}