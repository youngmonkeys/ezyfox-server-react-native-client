{"version":3,"names":["_ezyUtil","_interopRequireDefault","require","_ezyConstants","_ezyEntities","_ezyCodec","_ezyLogger","obj","__esModule","default","EzyConnectionSuccessHandler","constructor","clientType","clientVersion","handle","client","setStatus","Const","EzyConnectionStatus","CONNECTED","sendHandshakeRequest","postHandle","generateClientKey","clientKey","send","EzyCommand","HANDSHAKE","newHandshakeRequest","clientId","getClientId","token","getStoredToken","request","push","isEnableSSL","enableSSL","callback","EzyRSAProxy","getInstance","generateKeyPair","keyPair","privateKey","publicKey","Util","EzyGuid","generate","EzyConnectionFailureHandler","event","reason","reasonName","EzyConnectionFailedReasons","getConnectionFailedReasonName","EzyLogger","warn","preHandle","config","reconnectConfig","reconnect","should","shouldReconnect","mustReconnect","enable","FAILURE","success","onReconnecting","onConnectionFailed","EzyDisconnectionHandler","EzyDisconnectReasons","getDisconnectReasonName","info","reconnectEnable","EzyDisconnectReason","UNAUTHORIZED","CLOSE","DISCONNECTED","onDisconnected","ANOTHER_SESSION_LOGIN","EzyEventHandlers","handlers","addHandler","eventType","handler","getHandler","data","EzyHandshakeHandler","startPing","doHandle","onSessionKeyDecrypted","sessionKey","setSessionKey","handleLogin","sessionToken","sessionId","decryptSessionKey","encryptedSessionKey","enableDebug","error","close","decrypt","loginRequest","getLoginRequest","LOGIN","encryptedLoginRequest","startPingSchedule","EzyLoginSuccessHandler","zoneId","zoneName","userId","username","responseData","zone","Entity","EzyZone","user","EzyUser","me","handleLoginSuccess","name","EzyLoginErrorHandler","disconnect","handleLoginError","EzyAppAccessHandler","appManager","app","newApp","addApp","appId","appName","EzyApp","EzyAppExitHandler","reasonId","removeApp","EzyAppResponseHandler","cmd","commandData","getAppById","getDataHandler","EzyPluginInfoHandler","pluginManager","plugin","newPlugin","addPlugin","pluginId","pluginName","EzyPlugin","EzyPluginResponseHandler","getPluginById","EzyPongHandler","EzyDataHandlers","EzyAppDataHandlers","EzyPluginDataHandlers","_default","exports"],"sources":["ezy-handlers.js"],"sourcesContent":["import Util from './ezy-util';\nimport Const from './ezy-constants';\nimport Entity from './ezy-entities';\nimport { EzyRSAProxy } from './ezy-codec';\nimport EzyLogger from './ezy-logger';\n\nclass EzyConnectionSuccessHandler {\n    constructor() {\n        this.clientType = 'REACT_NATIVE';\n        this.clientVersion = '1.0.0';\n    }\n\n    handle() {\n        this.client.setStatus(Const.EzyConnectionStatus.CONNECTED);\n        this.sendHandshakeRequest();\n        this.postHandle();\n    }\n\n    postHandle() {}\n\n    sendHandshakeRequest() {\n        this.generateClientKey((clientKey) => {\n            this.client.send(\n                Const.EzyCommand.HANDSHAKE,\n                this.newHandshakeRequest(clientKey)\n            );\n        });\n    }\n\n    newHandshakeRequest(clientKey) {\n        var clientId = this.getClientId();\n        var token = this.getStoredToken();\n        var request = [];\n        request.push(clientId);\n        request.push(clientKey);\n        request.push(this.clientType);\n        request.push(this.clientVersion);\n        request.push(this.isEnableSSL(clientKey));\n        request.push(token);\n        return request;\n    }\n\n    isEnableSSL(clientKey) {\n        return this.client.enableSSL;\n    }\n\n    generateClientKey(callback) {\n        if (this.client.enableSSL) {\n            EzyRSAProxy.getInstance().generateKeyPair((keyPair) => {\n                this.client.privateKey = keyPair.privateKey;\n                callback(keyPair.publicKey);\n            });\n        } else {\n            callback();\n        }\n    }\n\n    getClientId() {\n        return Util.EzyGuid.generate();\n    }\n\n    getStoredToken() {\n        return '';\n    }\n}\n\n//=======================================================\n\nclass EzyConnectionFailureHandler {\n    handle(event) {\n        var reason = event.reason;\n        var reasonName =\n            Const.EzyConnectionFailedReasons.getConnectionFailedReasonName(\n                reason\n            );\n        EzyLogger.warn('connection failure, reason = ' + reasonName);\n        this.preHandle(event);\n        var config = this.client.config;\n        var reconnectConfig = config.reconnect;\n        var should = this.shouldReconnect(event);\n        var mustReconnect = reconnectConfig.enable && should;\n        this.client.setStatus(Const.EzyConnectionStatus.FAILURE);\n        if (mustReconnect) {\n            this.client.reconnect((success) => {\n                if (success) {\n                    this.onReconnecting(event);\n                } else {\n                    this.onConnectionFailed(event);\n                }\n                this.postHandle(event);\n            });\n        } else {\n            this.onConnectionFailed(event);\n            this.postHandle(event);\n        }\n    }\n\n    preHandle(event) {}\n\n    shouldReconnect(event) {\n        return true;\n    }\n\n    onReconnecting(event) {}\n\n    onConnectionFailed(event) {}\n\n    postHandle(event) {}\n}\n\n//=======================================================\n\nclass EzyDisconnectionHandler {\n    handle(event) {\n        var reason = event.reason;\n        var reasonName =\n            Const.EzyDisconnectReasons.getDisconnectReasonName(reason);\n        EzyLogger.info('handle disconnection, reason = ' + reasonName);\n        this.preHandle(event);\n        var config = this.client.config;\n        var reconnectConfig = config.reconnect;\n        var should = this.shouldReconnect(event);\n        var reconnectEnable = reconnectConfig.enable;\n        var mustReconnect =\n            reconnectEnable &&\n            reason !== Const.EzyDisconnectReason.UNAUTHORIZED &&\n            reason !== Const.EzyDisconnectReason.CLOSE &&\n            should;\n        this.client.setStatus(Const.EzyConnectionStatus.DISCONNECTED);\n        if (mustReconnect) {\n            this.client.reconnect((success) => {\n                if (success) {\n                    this.onReconnecting(event);\n                } else {\n                    this.onDisconnected(event);\n                }\n                this.postHandle(event);\n            });\n        } else {\n            this.onDisconnected(event);\n            this.postHandle(event);\n        }\n    }\n\n    preHandle(event) {}\n\n    shouldReconnect(event) {\n        var reason = event.reason;\n        if (reason === Const.EzyDisconnectReason.ANOTHER_SESSION_LOGIN) {\n            return false;\n        }\n        return true;\n    }\n\n    onReconnecting(event) {}\n\n    onDisconnected(event) {}\n\n    postHandle(event) {}\n}\n\n//======================================\n\nclass EzyEventHandlers {\n    constructor(client) {\n        this.handlers = {};\n        this.client = client;\n    }\n\n    addHandler(eventType, handler) {\n        handler.client = this.client;\n        this.handlers[eventType] = handler;\n    }\n\n    getHandler(eventType) {\n        var handler = this.handlers[eventType];\n        return handler;\n    }\n\n    handle(eventType, data) {\n        var handler = this.getHandler(eventType);\n        if (handler) handler.handle(data);\n        else EzyLogger.warn('has no handler with event: ' + eventType);\n    }\n}\n\n//======================================\n\nclass EzyHandshakeHandler {\n    handle(data) {\n        this.startPing();\n        this.doHandle(data);\n    }\n\n    onSessionKeyDecrypted(data, sessionKey, success) {\n        if (sessionKey) {\n            this.client.setSessionKey(sessionKey);\n        }\n        if (success) {\n            this.handleLogin();\n        }\n        this.postHandle(data);\n    }\n\n    doHandle(data) {\n        this.client.sessionToken = data[1];\n        this.client.sessionId = data[2];\n        if (this.client.enableSSL) {\n            this.decryptSessionKey(data[3], (sessionKey, success) => {\n                this.onSessionKeyDecrypted(data, sessionKey, success);\n            });\n        } else {\n            this.onSessionKeyDecrypted(data, null, true);\n        }\n    }\n\n    decryptSessionKey(encryptedSessionKey, callback) {\n        if (encryptedSessionKey == null) {\n            if (this.client.enableDebug) {\n                callback(null, true);\n                return;\n            }\n            EzyLogger.error(\n                'maybe server was not enable SSL, you must enable SSL on server or disable SSL on your client or enable debug mode'\n            );\n            this.client.close();\n            callback(null, false);\n            return;\n        }\n        EzyRSAProxy.getInstance().decrypt(\n            encryptedSessionKey,\n            this.client.privateKey,\n            (sessionKey) => {\n                callback(sessionKey, true);\n            }\n        );\n    }\n\n    postHandle(data) {}\n\n    handleLogin() {\n        var loginRequest = this.getLoginRequest();\n        this.client.send(\n            Const.EzyCommand.LOGIN,\n            loginRequest,\n            this.encryptedLoginRequest()\n        );\n    }\n\n    encryptedLoginRequest() {\n        return false;\n    }\n\n    getLoginRequest() {\n        return ['test', 'test', 'test', []];\n    }\n\n    startPing() {\n        this.client.startPingSchedule();\n    }\n}\n\n//=======================================================\n\nclass EzyLoginSuccessHandler {\n    handle(data) {\n        var zoneId = data[0];\n        var zoneName = data[1];\n        var userId = data[2];\n        var username = data[3];\n        var responseData = data[4];\n\n        var zone = new Entity.EzyZone(this.client, zoneId, zoneName);\n        var user = new Entity.EzyUser(userId, username);\n        this.client.me = user;\n        this.client.zone = zone;\n        this.handleLoginSuccess(responseData);\n        EzyLogger.info('user: ' + user.name + ' logged in successfully');\n    }\n\n    handleLoginSuccess(responseData) {}\n}\n\nclass EzyLoginErrorHandler {\n    handle(data) {\n        this.client.disconnect(401);\n        this.handleLoginError(data);\n    }\n\n    handleLoginError(data) {}\n}\n\n//=======================================================\n\nclass EzyAppAccessHandler {\n    handle(data) {\n        var zone = this.client.zone;\n        var appManager = zone.appManager;\n        var app = this.newApp(zone, data);\n        appManager.addApp(app);\n        this.postHandle(app, data);\n        EzyLogger.info('access app: ' + app.name + ' successfully');\n    }\n\n    newApp(zone, data) {\n        var appId = data[0];\n        var appName = data[1];\n        var app = new Entity.EzyApp(this.client, zone, appId, appName);\n        return app;\n    }\n\n    postHandle(app, data) {}\n}\n\n//======================================\n\nclass EzyAppExitHandler {\n    handle(data) {\n        var zone = this.client.zone;\n        var appManager = zone.appManager;\n        var appId = data[0];\n        var reasonId = data[1];\n        var app = appManager.removeApp(appId);\n        if (app) {\n            this.postHandle(app, data);\n            EzyLogger.info(\n                'user exit app: ' + app.name + ', reason: ' + reasonId\n            );\n        }\n    }\n\n    postHandle(app, data) {}\n}\n\n//=======================================================\n\nclass EzyAppResponseHandler {\n    handle(data) {\n        var appId = data[0];\n        var responseData = data[1];\n        var cmd = responseData[0];\n        var commandData = responseData[1];\n\n        var app = this.client.getAppById(appId);\n        var handler = app.getDataHandler(cmd);\n        if (handler) handler(app, commandData);\n        else\n            EzyLogger.warn(\n                'app: ' + app.name + ' has no handler for command: ' + cmd\n            );\n    }\n}\n\n//======================================\n\nclass EzyPluginInfoHandler {\n    handle(data) {\n        var zone = this.client.zone;\n        var pluginManager = zone.pluginManager;\n        var plugin = this.newPlugin(zone, data);\n        pluginManager.addPlugin(plugin);\n        this.postHandle(plugin, data);\n        EzyLogger.info('request plugin: ' + plugin.name + ' info successfully');\n    }\n\n    newPlugin(zone, data) {\n        var pluginId = data[0];\n        var pluginName = data[1];\n        var plugin = new Entity.EzyPlugin(\n            this.client,\n            zone,\n            pluginId,\n            pluginName\n        );\n        return plugin;\n    }\n\n    postHandle(plugin, data) {}\n}\n\n//======================================\n\nclass EzyPluginResponseHandler {\n    handle(data) {\n        var pluginId = data[0];\n        var responseData = data[1];\n        var cmd = responseData[0];\n        var commandData = responseData[1];\n\n        var plugin = this.client.getPluginById(pluginId);\n        var handler = plugin.getDataHandler(cmd);\n        if (handler) handler(plugin, commandData);\n        else\n            EzyLogger.info(\n                'plugin: ' + plugin.name + ' has no handler for command: ' + cmd\n            );\n    }\n}\n\n//=======================================================\n\nclass EzyPongHandler {\n    handle(data) {}\n}\n\n//=======================================================\n\nclass EzyDataHandlers {\n    constructor(client) {\n        this.handlers = {};\n        this.client = client;\n    }\n\n    addHandler(cmd, handler) {\n        handler.client = this.client;\n        this.handlers[cmd] = handler;\n    }\n\n    getHandler(cmd) {\n        var handler = this.handlers[cmd];\n        return handler;\n    }\n\n    handle(cmd, data) {\n        var handler = this.getHandler(cmd);\n        if (handler) handler.handle(data);\n        else EzyLogger.warn('has no handler with command: ' + cmd);\n    }\n}\n\n//=======================================================\n\nclass EzyAppDataHandlers {\n    constructor() {\n        this.handlers = {};\n    }\n\n    addHandler(cmd, handler) {\n        this.handlers[cmd] = handler;\n    }\n\n    getHandler(cmd) {\n        var handler = this.handlers[cmd];\n        return handler;\n    }\n}\n\n//======================================\n\nclass EzyPluginDataHandlers {\n    constructor() {\n        this.handlers = {};\n    }\n\n    addHandler(cmd, handler) {\n        this.handlers[cmd] = handler;\n    }\n\n    getHandler(cmd) {\n        var handler = this.handlers[cmd];\n        return handler;\n    }\n}\n\n//=======================================================\n\nexport default {\n    EzyConnectionSuccessHandler,\n    EzyConnectionFailureHandler,\n    EzyDisconnectionHandler,\n    EzyEventHandlers,\n    EzyHandshakeHandler,\n    EzyLoginSuccessHandler,\n    EzyLoginErrorHandler,\n    EzyAppAccessHandler,\n    EzyAppExitHandler,\n    EzyAppResponseHandler,\n    EzyPluginInfoHandler,\n    EzyPluginResponseHandler,\n    EzyPongHandler,\n    EzyAppDataHandlers,\n    EzyPluginDataHandlers,\n    EzyDataHandlers,\n};\n"],"mappings":"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"}