{"version":3,"names":["_proxy","_interopRequireDefault","require","_ezyManagers","_ezySetup","_ezyConstants","_ezyLogger","obj","__esModule","default","EzyClient","constructor","config","callback","Proxy","run2","toMap","outputConfig","name","clientName","enableSSL","enableDebug","zone","me","handlerManager","Manager","EzyHandlerManager","setup","EzySetup","connect","host","port","privateKey","sessionKey","run","reconnect","disconnect","reason","r","Const","EzyDisconnectReason","CLOSE","close","send","cmd","data","encrypted","shouldEncrypted","EzyLogger","error","params","requestParams","command","request","startPingSchedule","setStatus","status","setSessionKey","getApp","appManager","app","getAppById","appId","getPluginById","pluginId","pluginManager","newAppManager","zoneName","EzyAppManager","getAppManager","getPluginManager","handleEvent","eventType","eventHandlers","handle","handleData","dataHandlers","_default","exports"],"sources":["ezy-client.js"],"sourcesContent":["import Proxy from './proxy';\nimport Manager from './ezy-managers';\nimport EzySetup from './ezy-setup';\nimport Const from './ezy-constants';\nimport EzyLogger from './ezy-logger';\n\nclass EzyClient {\n    constructor(config, callback) {\n        Proxy.run2('init', config.toMap(), (outputConfig) => {\n            this.config = outputConfig;\n            this.name = outputConfig.clientName;\n            this.enableSSL = config.enableSSL;\n            this.enableDebug = config.enableDebug;\n            this.zone = null;\n            this.me = null;\n            this.handlerManager = new Manager.EzyHandlerManager(this);\n            this.setup = new EzySetup(this.handlerManager);\n            callback(this);\n        });\n    }\n\n    connect(host, port) {\n        this.privateKey = null;\n        this.sessionKey = null;\n        Proxy.run('connect', { clientName: this.name, host: host, port: port });\n    }\n\n    reconnect(callback) {\n        this.privateKey = null;\n        this.sessionKey = null;\n        Proxy.run2('reconnect', { clientName: this.name }, callback);\n    }\n\n    disconnect(reason) {\n        var r = reason ? reason : Const.EzyDisconnectReason.CLOSE;\n        Proxy.run('disconnect', { clientName: this.name, reason: r });\n    }\n\n    close() {\n        this.disconnect();\n    }\n\n    send(cmd, data, encrypted) {\n        var shouldEncrypted = encrypted;\n        if (encrypted && !this.sessionKey) {\n            if (this.enableDebug) {\n                shouldEncrypted = false;\n            } else {\n                EzyLogger.error(\n                    'can not send command: $cmd, you must enable SSL ' +\n                        'or enable debug mode by configuration when you create the client'\n                );\n                return;\n            }\n        }\n        var params = {};\n        params.clientName = this.name;\n        var requestParams = {};\n        requestParams.command = cmd;\n        requestParams.data = data;\n        requestParams.encrypted = shouldEncrypted;\n        params.request = requestParams;\n        Proxy.run('send', params);\n    }\n\n    startPingSchedule() {\n        Proxy.run('startPingSchedule', { clientName: this.name });\n    }\n\n    setStatus(status) {\n        Proxy.run('setStatus', { clientName: this.name, status: status });\n    }\n\n    setSessionKey(sessionKey) {\n        Proxy.run('setSessionKey', {\n            clientName: this.name,\n            sessionKey: sessionKey,\n        });\n    }\n\n    getApp() {\n        if (this.zone) {\n            var appManager = this.zone.appManager;\n            var app = appManager.getApp();\n            return app;\n        }\n        return null;\n    }\n\n    getAppById(appId) {\n        if (!this.zone) return null;\n        var appManager = this.zone.appManager;\n        return appManager.getAppById(appId);\n    }\n\n    getPluginById(pluginId) {\n        if (!this.zone) return null;\n        var pluginManager = this.zone.pluginManager;\n        return pluginManager.getPluginById(pluginId);\n    }\n\n    newAppManager(zoneName) {\n        return new Manager.EzyAppManager(zoneName);\n    }\n\n    getAppManager() {\n        if (!this.zone) return null;\n        return this.zone.appManager;\n    }\n\n    getPluginManager() {\n        if (!this.zone) return null;\n        return this.zone.pluginManager;\n    }\n\n    handleEvent(eventType, data) {\n        var eventHandlers = this.handlerManager.eventHandlers;\n        eventHandlers.handle(eventType, data);\n    }\n\n    handleData(command, data) {\n        var dataHandlers = this.handlerManager.dataHandlers;\n        dataHandlers.handle(command, data);\n    }\n}\n\nexport default EzyClient;\n"],"mappings":"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"}